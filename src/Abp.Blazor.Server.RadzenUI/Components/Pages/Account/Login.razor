@page "/login"
@using Abp.RadzenUI.Components.Layout
@using Volo.Abp.Account.Localization
@using Volo.Abp.AspNetCore.Components
@inherits AbpComponentBase
@layout LoginLayout

<PageTitle>@L["Login"]</PageTitle>

<RadzenTemplateForm Data=@("") Method="post" Action="/account/login">
    <RadzenLogin AllowRegister="true" AllowResetPassword="false" AllowRememberMe="true" RememberMe="true"
    UserText="@L["UserName"]" PasswordText="@L["Password"]"
    RememberMeText="@L["RememberMe"]" LoginText="@L["Login"]"
    RegisterText="@L["Register"]" RegisterMessageText="@L["AreYouANewUser"]" Register="GoToRegister" />
</RadzenTemplateForm>

<ExternalLoginProvider />

@code {
    [SupplyParameterFromQuery]
    [Parameter]
    public string? Error { get; set; }

    [Inject]
    NavigationManager Navigation { get; set; }

    public Login()
    {
        LocalizationResource = typeof(AccountResource);
    }

    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();

        if (!string.IsNullOrWhiteSpace(Error))
        {
            await Message.Error(Error);
        }

        if (CurrentUser != null && CurrentUser.IsAuthenticated)
        {
            Navigation.NavigateTo("/");
        }
    }

    public void GoToRegister()
    {
        Navigation.NavigateTo("/register");
    }
}