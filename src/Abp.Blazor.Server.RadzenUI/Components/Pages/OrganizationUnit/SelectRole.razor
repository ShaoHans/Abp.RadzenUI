@using Abp.RadzenUI.Application.Contracts.Organizations
@using Microsoft.AspNetCore.Authorization
@using Volo.Abp.Identity
@using Volo.Abp.Users
@inherits AbpRadzenUIComponentBase

<RadzenStack JustifyContent="JustifyContent.SpaceBetween"
             style="max-height:calc(100vh - 200px); display: flex;flex-direction:column">
    <div style="flex: 1; overflow: auto">
        <RadzenStack Gap="1rem">
            <RadzenDataGrid @ref="_grid" Data="@_entities" AllowPaging="true" AllowSorting="true"
                            PagerHorizontalAlign="HorizontalAlign.Center"
                            PageSizeOptions="@_pageSizeOptions" ShowPagingSummary="@_showPagerSummary" LoadData="LoadDataAsync"
                            Count="@_totalCount" IsLoading="@_isLoading" 
                            SelectionMode="DataGridSelectionMode.Multiple" @bind-Value="@_selectedRoles">
                <Columns>
                    <RadzenDataGridColumn Width="60px" Sortable="false" Filterable="false">
                        <HeaderTemplate>
                            <RadzenCheckBox TabIndex="-1" TriState="false" TValue="bool?" InputAttributes="@(new Dictionary<string, object>() { { "aria-label", "Select all items" } })"
                                            Value="@SelectAllValue"
                                            Change="@(args => _selectedRoles = args == true ? _entities.ToList() : [])" />
                        </HeaderTemplate>
                        <Template Context="data">
                            <RadzenCheckBox TabIndex="-1" TriState="false" Value="@(_selectedRoles != null && _selectedRoles.Contains(data))" InputAttributes="@(new Dictionary<string,object>(){ { "aria-label", "Select item" }})"
                                            TValue="bool"  />
                        </Template>
                    </RadzenDataGridColumn>
                    <RadzenDataGridColumn Title="@L["DisplayName:RoleName"]" Property="@nameof(IdentityRoleDto.Name)">
                        <Template>
                            <RadzenLabel Text="@context.Name" />
                            <RadzenBadge Text="@L["DisplayName:IsDefault"]" Visible="context.IsDefault" BadgeStyle="BadgeStyle.Success" />
                            <RadzenBadge Text="@L["DisplayName:IsPublic"]" Visible="context.IsPublic" BadgeStyle="BadgeStyle.Info" />
                        </Template>
                    </RadzenDataGridColumn>
                </Columns>
            </RadzenDataGrid>
        </RadzenStack>
    </div>
    <RadzenStack Orientation="Orientation.Horizontal" JustifyContent="JustifyContent.Right">
        <RadzenButton Icon="cancel" Text="@L["Cancel"]" ButtonStyle="ButtonStyle.Light" Click="@(() => DialogService.Close(false))" />
        <RadzenButton Icon="save" Text="@L["Save"]" ButtonType="ButtonType.Submit" Click="@SaveAsync" />
    </RadzenStack>
</RadzenStack>